<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>






    <!-- 

     -->

    <script>

        
//--------------------------异步方案--------------------------------
        {
            {
                // 普通回调
                function doSomething(cb){
                    setTimeout(function() {
                        cb("完成")
                    }, 1000)
                }
                doSomething(function(arg){
                    // console.log( "done here" , arg);
                })
            }
            {
                // // promise
                function doSomething2(){
                    return new Promise((reslove, reject) => {
                        setTimeout(function(){
                            reslove("promise 成功")
                        }, 2000)
                    }) 
                }
                doSomething2().then(function(res) {
                    // console.log(res)
                })
            }
            {
                // promise 代码优化
                { 
                    // // bad
                    // request(url, function(err, res, body) {
                    //     if (err) handleError(err);
                    //     fs.writeFile('1.txt', body, function(err) {
                    //         request(url2, function(err, res, body) {
                    //             if (err) handleError(err)
                    //         })
                    //     })
                    // });
                    
                    // // good
                    // request(url)
                    // .then(function(result) {
                    //     return writeFileAsynv('1.txt', result)
                    // })
                    // .then(function(result) {
                    //     return request(url2)
                    // })
                    // .catch(function(e){
                    //     handleError(e)
                    // });
                }
                // Promise finally
                {
                    // fetch('file.json')
                    // .then(data => data.json())
                    // .catch(error => console.error(error))
                    // .finally(() => console.log('finished'));
                }

                // async/await
                {
                    async function getItems() {
                        try {
                            const user = await getUser()
                            const order = await getOrderByUser(user)
                            const items = await getOrderItemsByOrder(order)
                            return items
                        } catch (error) {
                            // 在这里处理错误，建议返回某个值或者重新抛出错误
                        }
                    }
                    // getItems().then(item => {
                    //     // 处理排序后的成员
                    // })
                }
                  
            }
        }
    </script>
  </body>
</html>
